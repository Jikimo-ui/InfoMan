CREATE DATABASE InternetCafe;
USE InternetCafe;

CREATE TABLE Technician (
  TECH_ID CHAR(6) NOT NULL,
  TECH_FNAME VARCHAR(50) NOT NULL,
  TECH_LNAME VARCHAR(50) NOT NULL,
  TECH_SHIFT DATETIME NOT NULL,
  TECH_SALARY DECIMAL(9,2) NOT NULL,
  TECH_SPECIALIZATION VARCHAR(50) NOT NULL,
  PRIMARY KEY (TECH_ID)	
);

CREATE TABLE Computer (
  PC_ID CHAR(6) NOT NULL,
  PC_NUMBER INT NOT NULL,
  PC_STATUS ENUM('ACTIVE','INACTIVE','MAINTENANCE') NOT NULL,
  PC_SPECS ENUM('ENTRY LEVEL','MID RANGE','HIGH-END') NOT NULL,
  PC_LOC VARCHAR(20) NOT NULL,
  PC_LASTMAIN DATETIME NOT NULL,
  PC_SOFTWARE VARCHAR(50) NOT NULL,
  TECH_ID CHAR(6) NULL, 
  PRIMARY KEY (PC_ID),
  KEY TECH_ID_idx (TECH_ID),
  CONSTRAINT TECH_ID_FK FOREIGN KEY (TECH_ID) REFERENCES Technician (TECH_ID) ON DELETE SET NULL
);

CREATE TABLE Customer(
	CUS_ID CHAR(6) NOT NULL,
    CUS_USER VARCHAR(20) NOT NULL,
    CUS_PASS VARCHAR(20) NOT NULL,
    CUS_FNAME VARCHAR(20) NOT NULL,
    CUS_LNAME VARCHAR(20) NOT NULL,
    CUS_MEMBERSHIP_STAT ENUM('BASIC','PREMIUM') NOT NULL,
    PC_ID CHAR(6) NOT NULL,
	PRIMARY KEY (CUS_ID),
	KEY PC_ID_idx (PC_ID),
    CONSTRAINT PC_ID_FK FOREIGN KEY (PC_ID) REFERENCES Computer (PC_ID)
);

CREATE TABLE Cashier(
	CSHR_ID CHAR(6) NOT NULL,
    CSHR_FNAME VARCHAR(20) NOT NULL,
    CSHR_LNAME VARCHAR(20) NOT NULL,
    CSHR_SHIFT DATETIME NOT NULL,
    CSHR_SALARY DECIMAL(9,2) NOT NULL,
    PRIMARY KEY (CSHR_ID)
);

CREATE TABLE Access_Hours(
	ACC_TIME DATETIME NOT NULL,
    ACC_START DATETIME NOT NULL,
    ACC_END DATETIME NOT NULL,
    ACC_DURATION TIME NOT NULL,
    ACC_COST DECIMAL(9,2) NOT NULL,
    CUS_ID CHAR(6) NULL, -- NULLABLE --
    CSHR_ID CHAR(6) NULL,
	PRIMARY KEY (ACC_TIME),
	KEY CUS_ID_idx (CUS_ID),
    CONSTRAINT CUS_ID_ACC_FK FOREIGN KEY (CUS_ID) REFERENCES Customer (CUS_ID) ON DELETE CASCADE,
    KEY CSHR_ID_idx (CSHR_ID),
    CONSTRAINT CSHR_ID_ACC_FK FOREIGN KEY (CSHR_ID) REFERENCES Cashier (CSHR_ID) ON DELETE SET NULL
);

CREATE TABLE Transact(
	TRNSC_ID CHAR(6) NOT NULL,
    TRNSC_MOP ENUM('CASH', 'CASHLESS') NOT NULL,
    TRNSC_TIME TIME NOT NULL,
    TRNSC_DATE DATE NOT NULL,
    TRNSC_AMOUNT DECIMAL(9,2) NOT NULL,
    CUS_ID CHAR(6) NULL, -- NULLABLE --
    CSHR_ID CHAR(6) NULL,
    PRIMARY KEY (TRNSC_ID),
    KEY CUS_ID_idx (CUS_ID),
    CONSTRAINT CUS_ID_TRNSC_FK FOREIGN KEY (CUS_ID) REFERENCES Customer (CUS_ID) ON DELETE SET NULL,
    KEY CSHR_ID_idx (CSHR_ID),
    CONSTRAINT CSHR_ID_TRNSC_FK FOREIGN KEY (CSHR_ID) REFERENCES Cashier (CSHR_ID) ON DELETE SET NULL
);

/*
DESCRIBE Computer;
DESCRIBE Technician;
DESCRIBE Customer;
DESCRIBE Access_Hours;
DESCRIBE Cashier;
DESCRIBE Transact;
*/

INSERT INTO Technician (TECH_ID, TECH_FNAME, TECH_LNAME, TECH_SHIFT, TECH_SALARY, TECH_SPECIALIZATION)
VALUES
('T001', 'Alice', 'Garcia', '2025-11-07 08:00:00', 45000.00, 'Networking'),
('T002', 'Brian', 'Lopez', '2025-11-07 14:00:00', 52000.00, 'Hardware'),
('T003', 'Carla', 'Santos', '2025-11-07 22:00:00', 60000.00, 'Software');

INSERT INTO Computer (PC_ID, PC_NUMBER, PC_STATUS, PC_SPECS, PC_LOC, PC_LASTMAIN, PC_SOFTWARE, TECH_ID)
VALUES
('PC001', 101, 'ACTIVE', 'ENTRY LEVEL', 'Lab A', '2025-10-15 09:00:00', 'MS Office', 'T001'),
('PC002', 102, 'MAINTENANCE', 'MID RANGE', 'Lab B', '2025-09-20 10:00:00', 'AutoCAD', 'T002'),
('PC003', 103, 'INACTIVE', 'HIGH-END', 'Lab C', '2025-08-05 11:00:00', 'MATLAB', 'T003');

INSERT INTO Customer (CUS_ID, CUS_USER, CUS_PASS, CUS_FNAME, CUS_LNAME, CUS_MEMBERSHIP_STAT, PC_ID)
VALUES
('C001', 'jdoe', 'pass123', 'John', 'Doe', 'BASIC', 'PC001'),
('C002', 'asmith', 'mypwd456', 'Anna', 'Smith', 'PREMIUM', 'PC002'),
('C003', 'mchan', 'secure789', 'Michael', 'Chan', 'BASIC', 'PC003');

INSERT INTO Cashier (CSHR_ID, CSHR_FNAME, CSHR_LNAME, CSHR_SHIFT, CSHR_SALARY)
VALUES
('CS001', 'David', 'Reyes', '2025-11-07 08:00:00', 30000.00),
('CS002', 'Ella', 'Martinez', '2025-11-07 14:00:00', 32000.00),
('CS003', 'Frank', 'Torres', '2025-11-07 22:00:00', 35000.00);

INSERT INTO Access_Hours (ACC_TIME, ACC_START, ACC_END, ACC_DURATION, ACC_COST, CUS_ID, CSHR_ID)
VALUES
('2025-11-10 08:00:00', '2025-11-10 08:00:00', '2025-11-10 10:00:00', '02:00:00', 200.00, 'C001', 'CS001'),
('2025-11-11 14:00:00', '2025-11-11 14:00:00', '2025-11-11 16:30:00', '02:30:00', 250.00, 'C002', 'CS002'),
('2025-11-12 18:00:00', '2025-11-12 18:00:00', '2025-11-12 20:00:00', '02:00:00', 220.00, 'C003', 'CS003');

INSERT INTO Transact (TRNSC_ID, TRNSC_MOP, TRNSC_TIME, TRNSC_DATE, TRNSC_AMOUNT, CUS_ID, CSHR_ID)
VALUES
('TR001', 'CASH', '10:15:00', '2025-11-10', 200.00, 'C001', 'CS001'),
('TR002', 'CASHLESS', '16:45:00', '2025-11-11', 250.00, 'C002', 'CS002'),
('TR003', 'CASH', '20:10:00', '2025-11-12', 220.00, 'C003', 'CS003');

/*
SELECT * FROM Technician;
SELECT * FROM Computer;
SELECT * FROM Customer;
SELECT * FROM Cashier;
SELECT * FROM Access_Hours;
SELECT * FROM Transact;

CREATE VIEW COMB_TAB AS
SELECT 
    CUSTOMER.CUS_ID,
    CUSTOMER.CUS_FNAME,
    CUSTOMER.CUS_LNAME,
    
    COMPUTER.PC_ID,
    COMPUTER.PC_STATUS,
    COMPUTER.PC_SPECS,
    COMPUTER.PC_LOC,
    
    TECHNICIAN.TECH_ID,
    TECHNICIAN.TECH_FNAME,
    TECHNICIAN.TECH_LNAME
FROM CUSTOMER
JOIN COMPUTER 
    ON CUSTOMER.PC_ID = COMPUTER.PC_ID
JOIN TECHNICIAN 
    ON COMPUTER.TECH_ID = TECHNICIAN.TECH_ID;

SELECT * FROM COMB_TAB;
*/


